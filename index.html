<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign up | Burger King</title>
    <link rel="icon" type="image/x-icon" href="images/burger-king-logo.webp">
    <link rel="stylesheet" href="css/user.css">
</head>
<body>
    <div class="main">
        <div class="log-reg-container">
            <div class="left-side">
                <h1>BURGER KING</h1>
                <p>Experience the bold taste of flame-grilled perfection crafted exactly the way you like it. Sign in to access your account.</p>
            </div>
            <div class="right-side">
                <div class="log-type">
                    <button class="sign-in active" onclick="showLogin()">Sign In</button>
                    <button class="sign-up" onclick="showRegister()">Sign up</button>
                </div>
                <div class="forms">                                 
                    <form action="" class="signInFrm active">
                        <input type="email" name="" id="emailLogin" placeholder="Email Address" >
                        <input type="password" name="" id="passwordLogin" placeholder="Password" >
                        <button type="submit">Sign In</button>
                        <p id="loginMessage" style="color:red;"></p>
                    </form>                   
                    <form action="" class="signUpFrm">
                        <input type="text" name="" id="nameCreate" placeholder="Full Name" >
                        <input type="email" name="" id="emailCreate" placeholder="Email Address" >
                        <input type="password" name="" id="passwordCreate" placeholder="Password" >
                        <input type="password" name="" id="confirmPass" placeholder="Confirm Password" >
                        <button type="submit">Create Account</button>
                        <p id="registerMessage" style="color:red;"></p>
                    </form>
                    <a href="home.html" id="guestAccount">Continue without an account --></a>
                </div>
            </div>
        </div>
    </div>

    <script>
        const signIn = document.querySelector('.sign-in');
        const signUp = document.querySelector('.sign-up');
        const signInForm = document.querySelector('.signInFrm');
        const signUpForm = document.querySelector('.signUpFrm');

        function showLogin() {
            signUp.classList.remove('active')
            signIn.classList.add('active')
            signInForm.classList.add('active')
            signUpForm.classList.remove('active')
        }

        function showRegister() {
            signUp.classList.add('active')
            signIn.classList.remove('active')
            signInForm.classList.remove('active')
            signUpForm.classList.add('active')
        }

        let users =  JSON.parse(localStorage.getItem('users')) || [];

        document.querySelector('.signUpFrm').addEventListener('submit', function(event) {
            event.preventDefault();
            const name = document.querySelector('#nameCreate').value;
            const email = document.querySelector('#emailCreate').value;
            const password = document.querySelector('#passwordCreate').value;
            const confirmPass = document.querySelector('#confirmPass').value;
            const registerMessage = document.querySelector('#registerMessage');

            if(!name || !email || !password || !confirmPass) {
                registerMessage.textContent = "Please fill in all fields!";
                registerMessage.style.color = "red";
                return;
            }
            if(password !== confirmPass) {
                registerMessage.textContent = "Passwords do not match!"
                registerMessage.style.color = "red";
                return;
            }

            if(users.find(usr => usr.email === email)) {
                registerMessage.textContent = "Email is already registered!"
                registerMessage.style.color = "red";
                return;
            }

            const newUser = {name, email, password};
            users.push(newUser);
            
            localStorage.setItem("users", JSON.stringify(users));
            registerMessage.textContent = "Account is already created";
            registerMessage.style.color = "green";
            this.reset();
        });

        document.querySelector('.signInFrm').addEventListener('submit', function(event){
            event.preventDefault();
            const email = document.querySelector('#emailLogin').value;
            const password = document.querySelector('#passwordLogin').value;
            const loginMessage = document.querySelector('#loginMessage');

            const user = users.find(u => u.email === email && u.password === password);

            if(user){
                loginMessage.textContent = `Welcome ${user.name}`;
                loginMessage.style.color = "green";

                localStorage.setItem('loggedInUser', JSON.stringify(user));

                setTimeout(() => {                    
                    window.location.href = "home.html";
                }, 1000);
                this.reset();
            } else {
                loginMessage.textContent = "Email or password is incorrect!";
                loginMessage.style.color = "red";
            }
        });
    </script>

</body>
</html>


